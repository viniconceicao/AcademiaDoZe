<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
x:Class="AcademiaDoZe.Presentation.AppMaui.Views.LogradouroListPage"
xmlns:vm="clr-namespace:AcademiaDoZe.Presentation.AppMaui.ViewModels"
x:DataType="vm:LogradouroListViewModel"
xmlns:dto="clr-namespace:AcademiaDoZe.Application.DTOs;assembly=AcademiaDoZe.Application"
Title="{Binding Title}">
	<Grid RowDefinitions="Auto,*">
		<!-- Search Bar com Picker de filtro -->
		<Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="15,10">
			<Grid ColumnDefinitions="Auto,10,*,10,Auto" VerticalOptions="Center">
				<!-- Picker de filtro -->

				<Picker Grid.Column="0" Title="" ItemsSource="{Binding FilterTypes}" SelectedItem="{Binding SelectedFilterType}" WidthRequest="110"

				HorizontalOptions="Start" HeightRequest="40" VerticalOptions="Center"/>
				<!-- Entry de busca -->

				<Entry Grid.Column="2" Text="{Binding SearchText}" Placeholder="Digite o valor..." HeightRequest="40" VerticalOptions="Center" Margin="0,0,0,0"/>

				<!-- Botão de busca -->

				<Button Grid.Column="4" Text="Buscar" Style="{StaticResource ButtonPrimary}" FontSize="14" WidthRequest="80" HeightRequest="40" Margin="0,0,0,0"

				Command="{Binding SearchLogradourosCommand}"/>
			</Grid>
		</Border>
		<!-- Lista de Logradouros com FAB - "Floating Action Button" - Botão de Ação Flutuante -->
		<Grid Grid.Row="1">
			<RefreshView IsRefreshing="{Binding IsRefreshing}" Command="{Binding RefreshCommand}">
				<CollectionView ItemsSource="{Binding Logradouros}" SelectionMode="None">
					<CollectionView.EmptyView>
						<StackLayout VerticalOptions="Center">
							<Label Text="Nenhum logradouro encontrado" HorizontalOptions="Center" Style="{StaticResource SubHeadline}"/>
							<Button Text="Adicionar Primeiro Logradouro" Command="{Binding AddLogradouroCommand}" Style="{StaticResource ButtonPrimary}" HeightRequest="50" Margin="0,20,0,0"/>
						</StackLayout>
					</CollectionView.EmptyView>
					<CollectionView.ItemTemplate>
						<DataTemplate x:DataType="dto:LogradouroDTO">
							<Grid Padding="1" Margin="5">
								<Border Style="{StaticResource CardBorder}" Margin="10">
									<Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,Auto,Auto">
										<Label Grid.Row="0" Grid.Column="0" Text="{Binding Cep}" FontAttributes="Bold" Margin="0,0,0,5"/>
										<Label Grid.Row="1" Grid.Column="0" Text="{Binding Nome}" Margin="0,0,0,5"/>
										<Label Grid.Row="2" Grid.Column="0" Text="{Binding Bairro}" Margin="0,0,0,5"/>
										<Label Grid.Row="3" Grid.Column="0" Margin="0,0,0,5">
											<Label.FormattedText>
												<FormattedString>
													<Span Text="{Binding Cidade}"/>
													<Span Text=" - "/>
													<Span Text="{Binding Estado}"/>
												</FormattedString>
											</Label.FormattedText>
										</Label>

										<Label Grid.Row="4" Grid.Column="0" Text="{Binding Pais}" Margin="0,0,0,5"/>

										<!-- Botões de Ação -->

										<Button Grid.Row="0" Grid.Column="1" Text="Editar" Style="{StaticResource ButtonSmall}" Margin="4,0" Clicked="OnEditButtonClicked" />
										<Button Grid.Row="0" Grid.Column="2" Text="Excluir" Style="{StaticResource ButtonDanger}" Margin="4,0" Clicked="OnDeleteButtonClicked" />
									</Grid>
								</Border>
							</Grid>
						</DataTemplate>
					</CollectionView.ItemTemplate>
				</CollectionView>
			</RefreshView>
			<!-- Floating Action Button -->
			<Button Text="+" Command="{Binding AddLogradouroCommand}" Style="{StaticResource ButtonPrimary}"
			WidthRequest="56" HeightRequest="56" HorizontalOptions="End" VerticalOptions="End" Margin="20,20,20,20">
				<Button.Shadow>
					<Shadow Brush="{AppThemeBinding Light=Black, Dark=Gray}" Offset="0,4" Radius="8" Opacity="0.3"/>
				</Button.Shadow>
			</Button>
		</Grid>

		<!-- Loading Indicator -->
		<ActivityIndicator Grid.Row="0" Grid.RowSpan="2" IsVisible="{Binding IsBusy}" IsRunning="{Binding IsBusy}" VerticalOptions="Center" HorizontalOptions="Center"/>
	</Grid>
</ContentPage>